<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <title>Project - Cloud-based Malware Detection System</title>
    <link href='http://fonts.googleapis.com/css?family=Marcellus+SC' rel='stylesheet' type='text/css'>
    <link href="style.css" rel="stylesheet" type="text/css"/>

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-45990437-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-45990437-1');
    </script>
</head>

<body>

<div class="module">

<h1 class="title">Cloud-based Malware Detection System</h1>

<p>I was a research intern of <a href="http://www.tencent.com/en-us/index.shtml">Tencent</a> working on <a href="http://guanjia.qq.com/">QQ Computer Manager</a>. QQ Computer Manager was a cloud-based anti-virus engine and had more than 40 millions users. In the team, I was mainly responsible for the analysis of malwares collected from clients and the development of analysis platform.</p>

<p>Malware is becoming increasingly common and it is employed by criminal to steal valuable information from users, especially in China. Nowadays, most of anti-virus engines use signature-based malware detection. But malware can avoid this detection by changing their appearance automatically. For example, polymorphic viruses can transform code at the machine code level into functionally equivalent forms automatically. Because of this, malware analysts cannot combat malware using manual disassembly or reverse engineering. We need a tool that can analyze malware automatically.</p>

<p>Malware analysts often run a malware sample in a sandbox or a virtual machine to observe its behavior. If we can automate this process, we can save a lot of time. Automating this process means we need a dynamic analysis tool that can log the relevant behaviors during the execution of a sample such as:</p>
<ul><li>the files the sample accessed;</li>
<li>the processes that it created;</li>
<li>the network connections that it opened.</li></ul>

<p>While there are other projects attempting to solve this problem of automatically dynamic analysis, most of these projects either show some deficiencies or are closed projects with little information. We intends to remedy this by addressing some of the deficiencies and contributing source code back to research community.</p>

<p>Supposed we are considering Windows platform, there are two ways to implement a dynamic analysis tool described above. First, we can use API hooking which means intercepting a call to a function. When the sample calls an API function, we reroute it to our customized code - the hook function - resides by replace original machine code with a jump operation. Then the hook function performs our operations and transfer control back to the original API function. It is easy to implement API hooking and has little overhead. However, malware can detect API hooking easily and some malwares do this detection indeed. To solve this, we may use more complicated hooking techniques like SSDT hooking.</p>

<p>Second, we can also modify a processor emulator such as Bochs or QEMU so that it can unobtrusively monitor execution of malware samples within the emulated environment. This method is more difficult to detect for malware. But it needs much more effort to implement it. Another problem is the performance. A processor emulator needs to simulate every instruction in the machine code level which makes it relatively slow. However, because this dynamic analysis will be run in the server, so we can use advanced computers which may solve this performance problem.</p>

<p>An important problem about dynamic analysis is trigger execution. For example, a malware that intends to steal the password of a game such as World of Warcraft may not showed its malicious behaviors if the game is not installed in the analysis environment. To solve this problem, we can install common softwares like office suites, instant messengers and games in the dynamic analysis environment.</p>

<p>At last, the dynamic analysis tool can generate a report for malware sample automatically. An analysts can use the generated report as a high-level overview which can save a lot of time. Moreover, we can use statistically method to do analysis automatically. For example, we can classify a sample as malware if it executes a specific sequence of system API calls. Or we can apply machine learning algorithms on generated reports. For example, we can train support vector machine (SVM) classifier on reports of known malware and then use it to detect new malware.</p>

<p>In conclusion, if we can automate dynamic analysis, it can accelerate the process of current malware analysis. Moreover we may use it to analysis and find new malware automatically.</p>

</div>

</body>
</html>
